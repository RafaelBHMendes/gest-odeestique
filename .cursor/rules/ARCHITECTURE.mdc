# Arquitetura e PadrÃµes do Projeto

## ğŸ“‹ Ãndice

1. [VisÃ£o Geral](#visÃ£o-geral)
2. [Estrutura de Pastas](#estrutura-de-pastas)
3. [PadrÃµes de CÃ³digo](#padrÃµes-de-cÃ³digo)
4. [ConvenÃ§Ãµes de Nomenclatura](#convenÃ§Ãµes-de-nomenclatura)
5. [Gerenciamento de Estado](#gerenciamento-de-estado)
6. [ServiÃ§os e API](#serviÃ§os-e-api)
7. [Componentes](#componentes)
8. [TypeScript](#typescript)
9. [EstilizaÃ§Ã£o](#estilizaÃ§Ã£o)
10. [PreparaÃ§Ã£o para Backend](#preparaÃ§Ã£o-para-backend)

---

## ğŸ¯ VisÃ£o Geral

Este projeto segue uma arquitetura **modular e escalÃ¡vel**, preparada para evoluir de um MVP frontend-only para uma aplicaÃ§Ã£o full-stack completa.

### PrincÃ­pios Fundamentais

- **SeparaÃ§Ã£o de Responsabilidades**: Cada mÃ³dulo tem uma responsabilidade clara
- **ReutilizaÃ§Ã£o**: Componentes e utilitÃ¡rios sÃ£o compartilhados
- **Type Safety**: TypeScript em todo o cÃ³digo
- **Escalabilidade**: Estrutura preparada para crescimento
- **Manutenibilidade**: CÃ³digo limpo e bem organizado

---

## ğŸ“ Estrutura de Pastas

```
src/
â”œâ”€â”€ components/          # Componentes reutilizÃ¡veis (UI pura)
â”‚   â”œâ”€â”€ Alert.tsx
â”‚   â”œâ”€â”€ Modal.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ features/           # Features/pÃ¡ginas da aplicaÃ§Ã£o
â”‚   â”œâ”€â”€ products/
â”‚   â”‚   â”œâ”€â”€ ProductsPage.tsx
â”‚   â”‚   â”œâ”€â”€ ProductsList.tsx
â”‚   â”‚   â”œâ”€â”€ ProductForm.tsx
â”‚   â”‚   â””â”€â”€ AddProductPage.tsx
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ import/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ hooks/             # Custom React hooks
â”‚   â””â”€â”€ useInventory.ts
â”œâ”€â”€ services/          # LÃ³gica de negÃ³cio e comunicaÃ§Ã£o com API
â”‚   â”œâ”€â”€ products.ts
â”‚   â”œâ”€â”€ movements.ts
â”‚   â”œâ”€â”€ storage.ts     # LocalStorage (temporÃ¡rio)
â”‚   â””â”€â”€ api/           # Cliente HTTP (quando backend existir)
â”‚       â”œâ”€â”€ client.ts
â”‚       â”œâ”€â”€ products.ts
â”‚       â””â”€â”€ movements.ts
â”œâ”€â”€ lib/               # UtilitÃ¡rios e helpers
â”‚   â””â”€â”€ utils.ts
â”œâ”€â”€ types/             # DefiniÃ§Ãµes TypeScript
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ contexts/          # React Contexts (quando necessÃ¡rio)
â”œâ”€â”€ App.tsx            # Componente raiz
â”œâ”€â”€ main.tsx           # Entry point
â””â”€â”€ index.css          # Estilos globais
```

### Regras de Estrutura

- **`components/`**: Componentes genÃ©ricos e reutilizÃ¡veis. NÃ£o devem conter lÃ³gica de negÃ³cio.
- **`features/`**: Cada feature Ã© uma pasta com seus componentes especÃ­ficos.
- **`services/`**: Toda lÃ³gica de negÃ³cio e comunicaÃ§Ã£o externa.
- **`hooks/`**: Custom hooks para lÃ³gica reutilizÃ¡vel.
- **`types/`**: Tipos TypeScript compartilhados.
- **`lib/`**: FunÃ§Ãµes utilitÃ¡rias puras.

---

## ğŸ’» PadrÃµes de CÃ³digo

### Componentes React

#### Estrutura PadrÃ£o

```typescript
// 1. Imports (agrupados)
import { useState, useEffect } from 'react';
import { SomeType } from '../types';
import { someUtil } from '../lib/utils';
import { SomeComponent } from '../components/SomeComponent';

// 2. Types/Interfaces
interface ComponentProps {
  prop1: string;
  prop2?: number;
}

// 3. Componente
export function Component({ prop1, prop2 }: ComponentProps) {
  // 4. Hooks
  const [state, setState] = useState<string>('');
  
  // 5. Effects
  useEffect(() => {
    // ...
  }, []);
  
  // 6. Handlers
  const handleClick = () => {
    // ...
  };
  
  // 7. Render
  return (
    <div>
      {/* JSX */}
    </div>
  );
}
```

#### Regras

- âœ… Use **function components** (nÃ£o class components)
- âœ… Use **named exports** para componentes (`export function Component`)
- âœ… Props devem ser tipadas com `interface`
- âœ… Ordem: imports â†’ types â†’ componente â†’ handlers â†’ render
- âœ… Um componente por arquivo
- âœ… Nome do arquivo = Nome do componente (PascalCase)

### Hooks Customizados

```typescript
// hooks/useExample.ts
import { useState, useCallback } from 'react';

export function useExample() {
  const [value, setValue] = useState<string>('');
  
  const updateValue = useCallback((newValue: string) => {
    setValue(newValue);
  }, []);
  
  return {
    value,
    updateValue,
  };
}
```

**Regras:**
- âœ… Prefixo `use` obrigatÃ³rio
- âœ… Retornar objeto com valores e funÃ§Ãµes
- âœ… Usar `useCallback` para funÃ§Ãµes retornadas
- âœ… Documentar quando necessÃ¡rio

### ServiÃ§os

```typescript
// services/products.ts
import { Product, ProductFormData } from '../types';

export class ProductService {
  private products: Product[] = [];
  
  getAll(): Product[] {
    return [...this.products];
  }
  
  add(data: ProductFormData): Product {
    // LÃ³gica de negÃ³cio
  }
}
```

**Regras:**
- âœ… Classes para serviÃ§os complexos
- âœ… FunÃ§Ãµes puras para utilitÃ¡rios simples
- âœ… Sempre retornar cÃ³pias (nÃ£o mutar diretamente)
- âœ… Separar lÃ³gica de storage da lÃ³gica de negÃ³cio

---

## ğŸ·ï¸ ConvenÃ§Ãµes de Nomenclatura

### Arquivos e Pastas

- **Componentes**: `PascalCase.tsx` â†’ `ProductForm.tsx`
- **Hooks**: `camelCase.ts` com prefixo `use` â†’ `useInventory.ts`
- **ServiÃ§os**: `camelCase.ts` â†’ `products.ts` ou `ProductService.ts`
- **Types**: `camelCase.ts` â†’ `index.ts` (ou nome especÃ­fico)
- **UtilitÃ¡rios**: `camelCase.ts` â†’ `utils.ts`
- **Pastas**: `camelCase` â†’ `products`, `dashboard`

### VariÃ¡veis e FunÃ§Ãµes

- **VariÃ¡veis**: `camelCase` â†’ `productName`, `totalValue`
- **FunÃ§Ãµes**: `camelCase` â†’ `handleSubmit`, `formatCurrency`
- **Constantes**: `UPPER_SNAKE_CASE` â†’ `MAX_STOCK`, `API_BASE_URL`
- **Types/Interfaces**: `PascalCase` â†’ `Product`, `ProductFormData`
- **Enums**: `PascalCase` â†’ `MovementType`, `AlertType`

### Componentes React

- **Componentes**: `PascalCase` â†’ `<ProductForm />`
- **Props**: `camelCase` â†’ `onSubmit`, `isOpen`
- **Event Handlers**: `handle` + `Event` â†’ `handleSubmit`, `handleClick`

---

## ğŸ”„ Gerenciamento de Estado

### Estado Local vs Global

#### Estado Local (useState)
Use para estado que nÃ£o precisa ser compartilhado:
- FormulÃ¡rios
- Modais (aberto/fechado)
- Filtros locais

#### Estado Global (Custom Hooks)
Use para estado compartilhado:
- Lista de produtos
- MovimentaÃ§Ãµes
- ConfiguraÃ§Ãµes da aplicaÃ§Ã£o

### PadrÃ£o Atual (MVP)

```typescript
// hooks/useInventory.ts
export function useInventory() {
  const [products, setProducts] = useState<Product[]>([]);
  // ...
  return { products, addProduct, updateProduct };
}
```

### PadrÃ£o Futuro (com Backend)

```typescript
// hooks/useInventory.ts
export function useInventory() {
  const { data, isLoading, error } = useQuery('products', fetchProducts);
  const mutation = useMutation(createProduct);
  // ...
}
```

---

## ğŸŒ ServiÃ§os e API

### Estrutura Atual (LocalStorage)

```typescript
// services/storage.ts
export function saveProducts(products: Product[]): void {
  localStorage.setItem('products', JSON.stringify(products));
}
```

### Estrutura Futura (Backend)

```typescript
// services/api/client.ts
const apiClient = axios.create({
  baseURL: import.meta.env.VITE_API_URL,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Interceptor para autenticaÃ§Ã£o
apiClient.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// services/api/products.ts
export const productsApi = {
  getAll: () => apiClient.get<Product[]>('/products'),
  getById: (id: number) => apiClient.get<Product>(`/products/${id}`),
  create: (data: ProductFormData) => apiClient.post<Product>('/products', data),
  update: (id: number, data: Partial<ProductFormData>) => 
    apiClient.put<Product>(`/products/${id}`, data),
  delete: (id: number) => apiClient.delete(`/products/${id}`),
};
```

### MigraÃ§Ã£o de Storage para API

**EstratÃ©gia:**
1. Criar camada de abstraÃ§Ã£o (`services/products.ts`)
2. Implementar adaptadores (LocalStorage â†’ API)
3. Trocar implementaÃ§Ã£o sem alterar componentes

```typescript
// services/products.ts
interface IProductService {
  getAll(): Promise<Product[]>;
  add(data: ProductFormData): Promise<Product>;
}

// ImplementaÃ§Ã£o LocalStorage (atual)
class LocalProductService implements IProductService {
  // ...
}

// ImplementaÃ§Ã£o API (futuro)
class ApiProductService implements IProductService {
  // ...
}
```

---

## ğŸ§© Componentes

### Tipos de Componentes

#### 1. Componentes de UI (Presentational)
**LocalizaÃ§Ã£o**: `components/`
**Responsabilidade**: Apenas renderizaÃ§Ã£o

```typescript
interface ButtonProps {
  label: string;
  onClick: () => void;
  variant?: 'primary' | 'secondary';
}

export function Button({ label, onClick, variant = 'primary' }: ButtonProps) {
  return (
    <button className={`btn btn-${variant}`} onClick={onClick}>
      {label}
    </button>
  );
}
```

#### 2. Componentes de Feature (Container)
**LocalizaÃ§Ã£o**: `features/[feature]/`
**Responsabilidade**: LÃ³gica de negÃ³cio + UI

```typescript
export function ProductsPage() {
  const { products, addProduct } = useInventory();
  // LÃ³gica especÃ­fica da feature
  return <ProductsList products={products} />;
}
```

### Regras de Componentes

- âœ… MÃ¡ximo 200-300 linhas por componente
- âœ… Dividir em componentes menores quando necessÃ¡rio
- âœ… Props tipadas sempre
- âœ… Evitar prop drilling (usar Context se necessÃ¡rio)
- âœ… Componentes puros quando possÃ­vel

---

## ğŸ“˜ TypeScript

### Tipos e Interfaces

```typescript
// âœ… Preferir interface para objetos
interface Product {
  id: number;
  name: string;
}

// âœ… Usar type para unions, intersections, etc.
type Status = 'active' | 'inactive';
type ProductWithStatus = Product & { status: Status };

// âœ… Enums para valores fixos
enum MovementType {
  ENTRADA = 'entrada',
  SAIDA = 'saida',
}
```

### Regras TypeScript

- âœ… **Sempre** tipar props de componentes
- âœ… **Sempre** tipar retornos de funÃ§Ãµes
- âœ… Usar `interface` para objetos
- âœ… Usar `type` para unions/intersections
- âœ… Evitar `any` (usar `unknown` se necessÃ¡rio)
- âœ… Usar `as const` para objetos imutÃ¡veis

### Exemplo Completo

```typescript
// types/index.ts
export interface Product {
  id: number;
  name: string;
  price: number;
}

export type ProductFormData = Omit<Product, 'id'>;

// Componente
interface ProductFormProps {
  onSubmit: (data: ProductFormData) => void;
  initialData?: Partial<ProductFormData>;
}

export function ProductForm({ onSubmit, initialData }: ProductFormProps) {
  // ...
}
```

---

## ğŸ¨ EstilizaÃ§Ã£o

### Tailwind CSS + DaisyUI

#### PadrÃ£o de Classes

```typescript
// âœ… Usar classes do DaisyUI quando disponÃ­vel
<button className="btn btn-primary">Salvar</button>

// âœ… Combinar Tailwind + DaisyUI
<div className="card bg-base-100 shadow-md">
  <div className="card-body">
    {/* conteÃºdo */}
  </div>
</div>

// âœ… Evitar classes inline muito longas
// âŒ Ruim
<div className="flex items-center justify-between p-4 bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow">

// âœ… Bom (extrair para componente ou usar @apply)
<div className="product-card">
```

#### Regras de EstilizaÃ§Ã£o

- âœ… **Priorizar DaisyUI** para componentes comuns (buttons, cards, modals)
- âœ… **Tailwind** para layouts e utilitÃ¡rios
- âœ… **Evitar** CSS customizado (usar apenas quando necessÃ¡rio)
- âœ… **Classes condicionais** com template strings:
  ```typescript
  className={`btn ${isActive ? 'btn-primary' : 'btn-ghost'}`}
  ```

### Responsividade

```typescript
// âœ… Mobile-first
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
```

---

## ğŸš€ PreparaÃ§Ã£o para Backend

### Estrutura de Pastas Futura

```
src/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ api/              # Cliente HTTP e endpoints
â”‚   â”‚   â”œâ”€â”€ client.ts      # Axios/Fetch configurado
â”‚   â”‚   â”œâ”€â”€ products.ts    # Endpoints de produtos
â”‚   â”‚   â”œâ”€â”€ movements.ts   # Endpoints de movimentaÃ§Ãµes
â”‚   â”‚   â””â”€â”€ auth.ts        # AutenticaÃ§Ã£o
â”‚   â”œâ”€â”€ products.ts        # Service layer (abstraÃ§Ã£o)
â”‚   â””â”€â”€ movements.ts
```

### PadrÃ£o de Endpoints

```typescript
// services/api/products.ts
export const productsApi = {
  // GET /api/products
  getAll: (params?: { page?: number; limit?: number }) =>
    apiClient.get<Product[]>('/products', { params }),
  
  // GET /api/products/:id
  getById: (id: number) =>
    apiClient.get<Product>(`/products/${id}`),
  
  // POST /api/products
  create: (data: ProductFormData) =>
    apiClient.post<Product>('/products', data),
  
  // PUT /api/products/:id
  update: (id: number, data: Partial<ProductFormData>) =>
    apiClient.put<Product>(`/products/${id}`, data),
  
  // DELETE /api/products/:id
  delete: (id: number) =>
    apiClient.delete(`/products/${id}`),
};
```

### Tratamento de Erros

```typescript
// lib/errors.ts
export class ApiError extends Error {
  constructor(
    message: string,
    public statusCode: number,
    public data?: unknown
  ) {
    super(message);
    this.name = 'ApiError';
  }
}

// Uso
try {
  await productsApi.create(data);
} catch (error) {
  if (error instanceof ApiError) {
    showAlert(`Erro ${error.statusCode}: ${error.message}`, 'error');
  }
}
```

### Loading States

```typescript
// hooks/useApi.ts
export function useApi<T>(apiCall: () => Promise<T>) {
  const [data, setData] = useState<T | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<Error | null>(null);
  
  useEffect(() => {
    apiCall()
      .then(setData)
      .catch(setError)
      .finally(() => setIsLoading(false));
  }, []);
  
  return { data, isLoading, error };
}
```

### AutenticaÃ§Ã£o

```typescript
// contexts/AuthContext.tsx
interface AuthContextType {
  user: User | null;
  token: string | null;
  login: (email: string, password: string) => Promise<void>;
  logout: () => void;
  isAuthenticated: boolean;
}

export function AuthProvider({ children }: { children: ReactNode }) {
  // ImplementaÃ§Ã£o
}

// hooks/useAuth.ts
export function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within AuthProvider');
  }
  return context;
}
```

---

## ğŸ“ Checklist de Desenvolvimento

### Ao Criar um Novo Componente

- [ ] Arquivo em PascalCase
- [ ] Props tipadas com interface
- [ ] Export nomeado
- [ ] Responsivo (mobile-first)
- [ ] AcessÃ­vel (aria-labels quando necessÃ¡rio)

### Ao Criar um Novo ServiÃ§o

- [ ] Tipos definidos em `types/`
- [ ] FunÃ§Ãµes puras ou classe bem estruturada
- [ ] Tratamento de erros
- [ ] DocumentaÃ§Ã£o quando necessÃ¡rio

### Ao Criar uma Nova Feature

- [ ] Pasta em `features/[nome]/`
- [ ] Componentes especÃ­ficos da feature
- [ ] Hook customizado se necessÃ¡rio
- [ ] Tipos especÃ­ficos se necessÃ¡rio
- [ ] IntegraÃ§Ã£o com serviÃ§os

---

## ğŸ”® Roadmap de EvoluÃ§Ã£o

### Fase 1: MVP Frontend (Atual) âœ…
- [x] Estrutura base React + TS
- [x] LocalStorage como persistÃªncia
- [x] Componentes bÃ¡sicos
- [x] Features principais

### Fase 2: Backend Integration (PrÃ³ximo)
- [ ] Configurar cliente HTTP (Axios)
- [ ] Criar camada de abstraÃ§Ã£o API
- [ ] Migrar serviÃ§os para API
- [ ] Implementar loading states
- [ ] Tratamento de erros robusto

### Fase 3: AutenticaÃ§Ã£o
- [ ] AuthContext
- [ ] Rotas protegidas
- [ ] Refresh tokens
- [ ] GestÃ£o de sessÃ£o

### Fase 4: Multi-tenant
- [ ] Context de loja atual
- [ ] Filtros por loja
- [ ] Isolamento de dados

---

## ğŸ“š ReferÃªncias

- [React Best Practices](https://react.dev/learn)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [Tailwind CSS Docs](https://tailwindcss.com/docs)
- [DaisyUI Components](https://daisyui.com/components/)
- [Clean Code JavaScript](https://github.com/ryanmcdermott/clean-code-javascript)

---

**Ãšltima atualizaÃ§Ã£o**: 2024
**Mantido por**: Equipe de Desenvolvimento

